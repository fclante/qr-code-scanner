<div class="scan-result">
  <h2>Scanned Item Details</h2>
  
  <!-- Debug output -->
  <pre style="display: none;">
    Scanned Item: <%= JSON.stringify(scannedItem, null, 2) %>
    Existing Item: <%= JSON.stringify(existingItem, null, 2) %>
  </pre>
  
  <div class="scanned-details">
    <p><strong>ID:</strong> <%= scannedItem?.id || 'N/A' %></p>
    <p><strong>Name:</strong> <%= scannedItem?.name || 'N/A' %></p>
    <p><strong>Price:</strong> <%= scannedItem?.price || 0 %> kr</p>
    <p><strong>Quantity:</strong> <%= scannedItem?.quantity || 0 %></p>
    <p><strong>Date Added:</strong> <%= scannedItem?.date_added || 'N/A' %></p>
    <p><strong>Expiration Date:</strong> <%= scannedItem?.expiration_date || 'N/A' %></p>
    <p><strong>In Stock:</strong> <%= scannedItem?.in_stock ? 'Yes' : 'No' %></p>
  </div>

  <% if (existingItem) { %>
    <div class="existing-item">
      <h3>Item Already Exists in Database</h3>
      <div class="existing-details">
        <p><strong>Current ID:</strong> <%= existingItem.id %></p>
        <p><strong>Current Name:</strong> <%= existingItem.name %></p>
        <p><strong>Current Price:</strong> <%= existingItem.price %> kr</p>
        <p><strong>Current Quantity:</strong> <%= existingItem.quantity %></p>
        <p><strong>Current Date Added:</strong> <%= existingItem.date_added %></p>
        <p><strong>Current Expiration Date:</strong> <%= existingItem.expiration_date %></p>
        <p><strong>Current In Stock:</strong> <%= existingItem.in_stock ? 'Yes' : 'No' %></p>
      </div>

      <form action="/update/<%= existingItem.id %>" method="POST" id="updateForm">
        <input type="hidden" name="name" value="<%= scannedItem.name %>">
        <input type="hidden" name="price" value="<%= scannedItem.price %>">
        <input type="hidden" name="expiration_date" value="<%= scannedItem.expiration_date %>">
        <input type="hidden" name="quantity" value="<%= existingItem.quantity + scannedItem.quantity %>">
        <input type="hidden" name="date_added" value="<%= existingItem.date_added %>">
        <input type="hidden" name="in_stock" value="true">
        
        <div class="merge-preview">
          <p><strong>After Merging:</strong></p>
          <p>Total Quantity will be: <%= existingItem.quantity + scannedItem.quantity %></p>
        </div>

        <button type="submit" class="merge-button">
          Update Existing Item (Merge Quantities)
        </button>
      </form>
    </div>
  <% } else { %>
    <div class="new-item">
      <h3>New Item</h3>
      <form action="/create" method="POST">
        <input type="hidden" name="name" value="<%= scannedItem.name %>">
        <input type="hidden" name="price" value="<%= scannedItem.price %>">
        <input type="hidden" name="quantity" value="<%= scannedItem.quantity %>">
        <input type="hidden" name="expiration_date" value="<%= scannedItem.expiration_date %>">
        <input type="hidden" name="date_added" value="<%= new Date().toISOString().split('T')[0] %>">
        <input type="hidden" name="in_stock" value="true">
        
        <button type="submit" class="insert-button">
          Insert Into Database
        </button>
      </form>
    </div>
  <% } %>
</div>

<style>
.scan-result {
  max-width: 600px;
  margin: 20px auto;
  padding: 20px;
  border: 1px solid #ddd;
  border-radius: 8px;
}

.scanned-details, .existing-details {
  background: #f5f5f5;
  padding: 15px;
  border-radius: 5px;
  margin: 10px 0;
}

.merge-preview {
  background: #e8f4ff;
  padding: 10px;
  margin: 15px 0;
  border-radius: 5px;
}

button {
  padding: 10px 20px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-weight: bold;
  margin-top: 10px;
  width: 100%;
}

.merge-button {
  background-color: #4CAF50;
  color: white;
}

.insert-button {
  background-color: #2196F3;
  color: white;
}

button:hover {
  opacity: 0.9;
}
</style> 